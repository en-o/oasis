<!-- 管理模态框 -->
<div class="modal" id="manageModal">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">管理设置</h2>
      <button class="close-btn" id="closeModalBtn">×</button>
    </div>

    <div class="tab-buttons" id="tabButtons">
      <button class="tab-button active" data-tab="category">分类管理</button>
      <button class="tab-button" data-tab="site">网站管理</button>
      <button class="tab-button" data-tab="engine">搜索引擎</button>
      <button class="tab-button" data-tab="sync">数据同步</button>
    </div>

    <!-- 分类管理 -->
    <div id="categoryManage" class="tab-content">
      <div class="form-group">
        <label class="form-label">分类名称</label>
        <input type="text" class="form-input" id="categoryName">
      </div>
      <button class="btn btn-primary" id="addCategoryBtn">添加分类</button>
      <div id="categoryList" style="margin-top: 20px;"></div>
    </div>

    <!-- 网站管理 -->
    <div id="siteManage" class="tab-content" style="display: none;">
      <div class="form-group">
        <label class="form-label">选择分类</label>
        <select class="form-input" id="siteCategory"></select>
      </div>
      <div class="form-group">
        <label class="form-label">网站名称</label>
        <input type="text" class="form-input" id="siteName">
      </div>
      <div class="form-group">
        <label class="form-label">网站描述</label>
        <input type="text" class="form-input" id="siteDesc" placeholder="简短描述此网站">
      </div>
      <div class="form-group">
        <label class="form-label">网站图标</label>
        <div style="display: flex; gap: 12px; margin-bottom: 8px;">
          <label style="display: flex; align-items: center; cursor: pointer;">
            <input type="radio" name="iconType" value="text" id="iconTypeText" checked style="margin-right: 6px;">
            <span style="font-size: 14px; color: #202124;">文字/Emoji</span>
          </label>
          <label style="display: flex; align-items: center; cursor: pointer;">
            <input type="radio" name="iconType" value="url" id="iconTypeUrl" style="margin-right: 6px;">
            <span style="font-size: 14px; color: #202124;">在线图标</span>
          </label>
        </div>
        <input type="text" class="form-input" id="siteIcon" placeholder="🌐">
        <input type="text" class="form-input" id="siteIconUrl" placeholder="https://example.com/favicon.ico" style="display: none;">
        <div style="margin-top: 8px; font-size: 12px; color: #5f6368;" id="iconTypeHint">
          输入表情符号或1-2个文字作为图标
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">网站地址</label>
        <input type="text" class="form-input" id="siteUrl" placeholder="https://example.com">
      </div>
      <div class="form-group">
        <label class="form-label">账号信息(可选)</label>
        <div class="account-fields" id="accountFields">
          <!-- 动态生成账号字段 -->
        </div>
        <button class="add-field-btn" id="addFieldBtn">+ 添加字段</button>
      </div>
      <button class="btn btn-primary" id="saveSiteBtn">添加网站</button>
      <button class="btn btn-secondary" id="cancelEditBtn" style="display: none;">取消编辑</button>
      <div id="siteList" style="margin-top: 20px;"></div>
    </div>

    <!-- 搜索引擎管理 -->
    <div id="engineManage" class="tab-content" style="display: none;">
      <div class="form-group">
        <label class="form-label">引擎名称</label>
        <input type="text" class="form-input" id="engineName">
      </div>
      <div class="form-group">
        <label class="form-label">搜索URL (用 {query} 代替搜索词)</label>
        <input type="text" class="form-input" id="engineUrl" placeholder="https://www.google.com/search?q={query}">
      </div>
      <button class="btn btn-primary" id="addEngineBtn">添加搜索引擎</button>
      <div id="engineList" style="margin-top: 20px;"></div>
    </div>

    <!-- 数据同步 -->
    <div id="syncManage" class="tab-content" style="display: none;">
      <div style="margin-bottom: 24px; padding: 16px; background: #e8f0fe; border-radius: 8px; border-left: 4px solid #1a73e8;">
        <div style="font-size: 14px; color: #202124; margin-bottom: 8px;">
          <strong>🔄 自动云端同步</strong>
        </div>
        <div style="font-size: 13px; color: #5f6368; line-height: 1.5;">
          当您登录 Chrome/Edge 账号后，所有数据会自动同步到云端。<br>
          在其他设备上安装此插件并登录相同账号，即可自动同步所有设置。
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">手动备份与恢复</label>
        <div style="display: flex; gap: 8px; margin-top: 12px;">
          <button class="btn btn-primary" id="exportDataBtn" style="flex: 1;">
            📥 导出数据
          </button>
          <button class="btn btn-secondary" id="importDataBtn" style="flex: 1;">
            📤 导入数据
          </button>
        </div>
        <input type="file" id="importFile" accept=".json" style="display: none;">
        <div style="font-size: 12px; color: #5f6368; margin-top: 8px;">
          导出的 JSON 文件可用于备份或迁移到其他浏览器
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">导入浏览器书签</label>
        <button class="btn btn-secondary" id="importBookmarksBtn" style="width: 100%;">
          📚 导入浏览器书签
        </button>
        <div style="font-size: 12px; color: #5f6368; margin-top: 8px;">
          将浏览器书签导入到导航助手中，支持自动识别文件夹为分类
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">百度网盘同步</label>
        <div style="margin-bottom: 12px; padding: 12px; background: #e8f0fe; border-radius: 4px; border-left: 4px solid #1a73e8;">
          <div style="font-size: 13px; color: #202124; margin-bottom: 4px;">
            <strong>使用说明</strong>
          </div>
          <div style="font-size: 12px; color: #5f6368; line-height: 1.5;">
            1. 点击"登录百度网盘"按钮,在新窗口登录您的百度账号<br>
            2. 登录成功后会自动获取并保存认证信息（弹窗没关闭自己主动关闭）<br>
            3. 使用"备份到百度网盘"和"从百度网盘恢复"进行数据同步 <br>
            4. 备份位置：/apps(我的应用数据)/oasis-nav
          </div>
        </div>
        <div style="margin-bottom: 12px;">
          <button class="btn btn-primary" id="baiduLoginBtn" style="width: 100%;">
            登录百度网盘
          </button>
          <div style="margin-top: 8px; font-size: 12px; color: #5f6368;" id="baiduSyncStatus">
            未登录
          </div>
        </div>
        <div style="display: flex; gap: 8px;">
          <button class="btn btn-primary" id="syncToBaiduBtn" style="flex: 1;">
            ☁️ 备份到百度网盘
          </button>
          <button class="btn btn-secondary" id="syncFromBaiduBtn" style="flex: 1;">
            ⬇️ 从百度网盘恢复
          </button>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">备份文件解压工具</label>
        <button class="btn btn-secondary" id="decompressBackupBtn" style="width: 100%;">
          📦 解压备份文件
        </button>
        <input type="file" id="decompressFile" accept=".json,.txt" style="display: none;">
        <div style="font-size: 12px; color: #5f6368; margin-top: 8px;">
          选择压缩的备份文件，自动解压并下载可读的 JSON 文件
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">存储信息</label>
        <div style="padding: 12px; background: #f8f9fa; border-radius: 4px; font-size: 13px; color: #5f6368;" id="storageInfo">
          加载中...
        </div>
      </div>

      <div class="form-group">
        <label class="form-label" style="color: #d93025;">危险操作</label>
        <button class="btn" id="clearDataBtn" style="background: #fff; color: #d93025; border: 1px solid #d93025;">
          🗑️ 清空所有数据
        </button>
        <div style="font-size: 12px; color: #5f6368; margin-top: 8px;">
          此操作将删除所有分类、网站和搜索引擎，且不可恢复
        </div>
      </div>
    </div>
  </div>
</div>
