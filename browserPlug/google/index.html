<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ™ºèƒ½å¯¼èˆªåŠ©æ‰‹</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 40px 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* æœç´¢æ æ ·å¼ */
    .search-section {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    }

    .search-box {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .engine-select {
      padding: 15px 20px;
      border: 2px solid #e0e0e0;
      border-radius: 25px;
      font-size: 16px;
      outline: none;
      background: white;
      cursor: pointer;
      transition: border-color 0.3s;
      min-width: 140px;
    }

    .engine-select:focus {
      border-color: #667eea;
    }

    .search-input {
      flex: 1;
      padding: 15px 20px;
      border: 2px solid #e0e0e0;
      border-radius: 25px;
      font-size: 16px;
      outline: none;
      transition: border-color 0.3s;
    }

    .search-input:focus {
      border-color: #667eea;
    }

    .search-btn {
      padding: 15px 30px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s;
      white-space: nowrap;
    }

    .search-btn:hover {
      background: #5568d3;
    }

    /* åˆ†ç±»å’Œå¯¼èˆªæ ·å¼ */
    .nav-section {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    }

    .category-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 10px;
      flex-wrap: wrap;
    }

    .category-tab {
      padding: 10px 20px;
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 15px;
      color: #666;
      transition: all 0.3s;
      border-radius: 8px 8px 0 0;
    }

    .category-tab.active {
      background: #667eea;
      color: white;
    }

    .sites-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .site-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      border: 2px solid transparent;
      position: relative;
    }

    .site-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      border-color: #667eea;
    }

    .site-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      margin: 0 auto 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .site-name {
      font-weight: 600;
      margin-bottom: 5px;
      color: #333;
    }

    .site-url {
      font-size: 12px;
      color: #999;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .site-info {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid #f0f0f0;
      font-size: 12px;
      color: #666;
    }

    /* ç®¡ç†æŒ‰é’® */
    .manage-btn {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: #667eea;
      color: white;
      border: none;
      cursor: pointer;
      font-size: 24px;
      box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      transition: all 0.3s;
    }

    .manage-btn:hover {
      transform: scale(1.1);
    }

    /* æ¨¡æ€æ¡†æ ·å¼ */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: 16px;
      padding: 30px;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-title {
      font-size: 24px;
      font-weight: 600;
    }

    .close-btn {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #999;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #333;
    }

    .form-input {
      width: 100%;
      padding: 10px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      outline: none;
    }

    .form-input:focus {
      border-color: #667eea;
    }

    .form-textarea {
      min-height: 100px;
      resize: vertical;
    }

    .btn-group {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .btn {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s;
    }

    .btn-primary {
      background: #667eea;
      color: white;
    }

    .btn-primary:hover {
      background: #5568d3;
    }

    .btn-secondary {
      background: #e0e0e0;
      color: #666;
    }

    .tab-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .tab-button {
      flex: 1;
      padding: 10px;
      border: 2px solid #e0e0e0;
      background: white;
      border-radius: 8px;
      cursor: pointer;
    }

    .tab-button.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .list-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .delete-btn {
      background: #ff4757;
      color: white;
      border: none;
      padding: 5px 15px;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- æœç´¢åŒºåŸŸ -->
    <div class="search-section">
      <div class="search-box">
        <select class="engine-select" id="engineSelect">
          <!-- åŠ¨æ€ç”Ÿæˆé€‰é¡¹ -->
        </select>
        <input type="text" class="search-input" id="searchInput" placeholder="è¾“å…¥æœç´¢å†…å®¹...">
        <button class="search-btn" onclick="performSearch()">æœç´¢</button>
      </div>
    </div>

    <!-- å¯¼èˆªåŒºåŸŸ -->
    <div class="nav-section">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <div class="category-tabs" id="categoryTabs" style="margin-bottom: 0; border-bottom: none; padding-bottom: 0; flex: 1;"></div>
        <button class="search-btn" onclick="openManageModal()" style="padding: 10px 20px; margin-left: 10px;">âš™ï¸ ç®¡ç†</button>
      </div>
      <div class="sites-grid" id="sitesGrid"></div>
    </div>
  </div>

  <!-- ç®¡ç†æŒ‰é’® -->
  <button class="manage-btn" onclick="openManageModal()">âš™ï¸</button>

  <!-- ç®¡ç†æ¨¡æ€æ¡† -->
  <div class="modal" id="manageModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">ç®¡ç†è®¾ç½®</h2>
        <button class="close-btn" onclick="closeManageModal()">Ã—</button>
      </div>

      <div class="tab-buttons">
        <button class="tab-button active" onclick="switchTab('category')">åˆ†ç±»ç®¡ç†</button>
        <button class="tab-button" onclick="switchTab('site')">ç½‘ç«™ç®¡ç†</button>
        <button class="tab-button" onclick="switchTab('engine')">æœç´¢å¼•æ“</button>
      </div>

      <!-- åˆ†ç±»ç®¡ç† -->
      <div id="categoryManage" class="tab-content">
        <div class="form-group">
          <label class="form-label">åˆ†ç±»åç§°</label>
          <input type="text" class="form-input" id="categoryName">
        </div>
        <button class="btn btn-primary" onclick="addCategory()">æ·»åŠ åˆ†ç±»</button>
        <div id="categoryList" style="margin-top: 20px;"></div>
      </div>

      <!-- ç½‘ç«™ç®¡ç† -->
      <div id="siteManage" class="tab-content" style="display: none;">
        <div class="form-group">
          <label class="form-label">é€‰æ‹©åˆ†ç±»</label>
          <select class="form-input" id="siteCategory"></select>
        </div>
        <div class="form-group">
          <label class="form-label">ç½‘ç«™åç§°</label>
          <input type="text" class="form-input" id="siteName">
        </div>
        <div class="form-group">
          <label class="form-label">ç½‘ç«™å›¾æ ‡(emoji æˆ–æ–‡å­—)</label>
          <input type="text" class="form-input" id="siteIcon" placeholder="ğŸŒ">
        </div>
        <div class="form-group">
          <label class="form-label">ç½‘ç«™åœ°å€</label>
          <input type="text" class="form-input" id="siteUrl" placeholder="https://example.com">
        </div>
        <div class="form-group">
          <label class="form-label">è´¦å·ä¿¡æ¯(å¯é€‰)</label>
          <textarea class="form-input form-textarea" id="siteInfo" placeholder="è´¦å·: xxx&#10;å¯†ç : xxx&#10;å¤‡æ³¨: xxx"></textarea>
        </div>
        <button class="btn btn-primary" onclick="addSite()">æ·»åŠ ç½‘ç«™</button>
        <div id="siteList" style="margin-top: 20px;"></div>
      </div>

      <!-- æœç´¢å¼•æ“ç®¡ç† -->
      <div id="engineManage" class="tab-content" style="display: none;">
        <div class="form-group">
          <label class="form-label">å¼•æ“åç§°</label>
          <input type="text" class="form-input" id="engineName">
        </div>
        <div class="form-group">
          <label class="form-label">æœç´¢URL (ç”¨ {query} ä»£æ›¿æœç´¢è¯)</label>
          <input type="text" class="form-input" id="engineUrl" placeholder="https://www.google.com/search?q={query}">
        </div>
        <button class="btn btn-primary" onclick="addEngine()">æ·»åŠ æœç´¢å¼•æ“</button>
        <div id="engineList" style="margin-top: 20px;"></div>
      </div>
    </div>
  </div>

  <script>
    // é»˜è®¤æ•°æ®
    const defaultData = {
      engines: [
        { name: 'Google', url: 'https://www.google.com/search?q={query}' },
        { name: 'Bing', url: 'https://www.bing.com/search?q={query}' },
        { name: 'Baidu', url: 'https://www.baidu.com/s?wd={query}' }
      ],
      categories: ['å¸¸ç”¨', 'å·¥ä½œ', 'å¨±ä¹'],
      sites: {
        'å¸¸ç”¨': [
          { name: 'Google', icon: 'ğŸ”', url: 'https://www.google.com', info: '' },
          { name: 'GitHub', icon: 'ğŸ’»', url: 'https://github.com', info: '' }
        ],
        'å·¥ä½œ': [],
        'å¨±ä¹': []
      }
    };

    let data = JSON.parse(JSON.stringify(defaultData));
    let currentEngine = 'Google';
    let currentCategory = 'å¸¸ç”¨';

    // åˆå§‹åŒ–
    function init() {
      const stored = localStorage.getItem('navData');
      if (stored) {
        data = JSON.parse(stored);
      } else {
        saveData();
      }
      renderEngines();
      renderCategories();
      renderSites();
    }

    function saveData() {
      localStorage.setItem('navData', JSON.stringify(data));
    }

    // æ¸²æŸ“æœç´¢å¼•æ“
    function renderEngines() {
      const select = document.getElementById('engineSelect');
      select.innerHTML = data.engines.map(e => 
        `<option value="${e.name}" ${e.name === currentEngine ? 'selected' : ''}>${e.name}</option>`
      ).join('');
      
      // ç›‘å¬ä¸‹æ‹‰é€‰æ‹©å˜åŒ–
      select.onchange = function() {
        currentEngine = this.value;
      };
    }

    function performSearch() {
      const query = document.getElementById('searchInput').value.trim();
      if (!query) return;
      
      const engine = data.engines.find(e => e.name === currentEngine);
      if (engine) {
        const url = engine.url.replace('{query}', encodeURIComponent(query));
        window.location.href = url;
      }
    }

    // æ¸²æŸ“åˆ†ç±»
    function renderCategories() {
      const container = document.getElementById('categoryTabs');
      container.innerHTML = data.categories.map(c => 
        `<button class="category-tab ${c === currentCategory ? 'active' : ''}"
                onclick="selectCategory('${c}')">${c}</button>`
      ).join('');
    }

    function selectCategory(name) {
      currentCategory = name;
      renderCategories();
      renderSites();
    }

    // æ¸²æŸ“ç½‘ç«™
    function renderSites() {
      const container = document.getElementById('sitesGrid');
      const sites = data.sites[currentCategory] || [];
      
      container.innerHTML = sites.map((site, i) => `
        <div class="site-card" onclick="openSite('${site.url}')">
          <div class="site-avatar">${site.icon}</div>
          <div class="site-name">${site.name}</div>
          <div class="site-url">${site.url}</div>
          ${site.info ? `<div class="site-info">${site.info.replace(/\n/g, '<br>')}</div>` : ''}
        </div>
      `).join('');
    }

    function openSite(url) {
      window.location.href = url;
    }

    // æ¨¡æ€æ¡†ç®¡ç†
    function openManageModal() {
      document.getElementById('manageModal').classList.add('active');
      renderManageLists();
    }

    function closeManageModal() {
      document.getElementById('manageModal').classList.remove('active');
    }

    function switchTab(tab) {
      document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
      
      document.getElementById('categoryManage').style.display = tab === 'category' ? 'block' : 'none';
      document.getElementById('siteManage').style.display = tab === 'site' ? 'block' : 'none';
      document.getElementById('engineManage').style.display = tab === 'engine' ? 'block' : 'none';
    }

    function renderManageLists() {
      // æ¸²æŸ“åˆ†ç±»åˆ—è¡¨
      const categoryList = document.getElementById('categoryList');
      categoryList.innerHTML = data.categories.map((c, i) => `
        <div class="list-item">
          <span>${c}</span>
          <button class="delete-btn" onclick="deleteCategory(${i})">åˆ é™¤</button>
        </div>
      `).join('');

      // æ¸²æŸ“ç½‘ç«™é€‰æ‹©åˆ†ç±»
      const siteCategory = document.getElementById('siteCategory');
      siteCategory.innerHTML = data.categories.map(c => 
        `<option value="${c}">${c}</option>`
      ).join('');

      // æ¸²æŸ“ç½‘ç«™åˆ—è¡¨
      const siteList = document.getElementById('siteList');
      const category = siteCategory.value || data.categories[0];
      const sites = data.sites[category] || [];
      siteList.innerHTML = sites.map((s, i) => `
        <div class="list-item">
          <span>${s.icon} ${s.name}</span>
          <button class="delete-btn" onclick="deleteSite('${category}', ${i})">åˆ é™¤</button>
        </div>
      `).join('');

      // æ¸²æŸ“æœç´¢å¼•æ“åˆ—è¡¨
      const engineList = document.getElementById('engineList');
      engineList.innerHTML = data.engines.map((e, i) => `
        <div class="list-item">
          <span>${e.name}</span>
          <button class="delete-btn" onclick="deleteEngine(${i})">åˆ é™¤</button>
        </div>
      `).join('');
    }

    // æ·»åŠ åŠŸèƒ½
    function addCategory() {
      const name = document.getElementById('categoryName').value.trim();
      if (!name) return alert('è¯·è¾“å…¥åˆ†ç±»åç§°');
      if (data.categories.includes(name)) return alert('åˆ†ç±»å·²å­˜åœ¨');
      
      data.categories.push(name);
      data.sites[name] = [];
      saveData();
      renderCategories();
      renderManageLists();
      document.getElementById('categoryName').value = '';
    }

    function addSite() {
      const category = document.getElementById('siteCategory').value;
      const name = document.getElementById('siteName').value.trim();
      const icon = document.getElementById('siteIcon').value.trim() || 'ğŸŒ';
      const url = document.getElementById('siteUrl').value.trim();
      const info = document.getElementById('siteInfo').value.trim();
      
      if (!name || !url) return alert('è¯·å¡«å†™ç½‘ç«™åç§°å’Œåœ°å€');
      
      if (!data.sites[category]) data.sites[category] = [];
      data.sites[category].push({ name, icon, url, info });
      
      saveData();
      renderSites();
      renderManageLists();
      
      document.getElementById('siteName').value = '';
      document.getElementById('siteIcon').value = '';
      document.getElementById('siteUrl').value = '';
      document.getElementById('siteInfo').value = '';
    }

    function addEngine() {
      const name = document.getElementById('engineName').value.trim();
      const url = document.getElementById('engineUrl').value.trim();
      
      if (!name || !url) return alert('è¯·å¡«å†™å¼•æ“åç§°å’ŒURL');
      if (!url.includes('{query}')) return alert('URLå¿…é¡»åŒ…å« {query}');
      
      data.engines.push({ name, url });
      saveData();
      renderEngines();
      renderManageLists();
      
      document.getElementById('engineName').value = '';
      document.getElementById('engineUrl').value = '';
    }

    // åˆ é™¤åŠŸèƒ½
    function deleteCategory(index) {
      if (!confirm('ç¡®å®šåˆ é™¤æ­¤åˆ†ç±»åŠå…¶æ‰€æœ‰ç½‘ç«™?')) return;
      const category = data.categories[index];
      data.categories.splice(index, 1);
      delete data.sites[category];
      if (currentCategory === category) {
        currentCategory = data.categories[0];
      }
      saveData();
      renderCategories();
      renderSites();
      renderManageLists();
    }

    function deleteSite(category, index) {
      if (!confirm('ç¡®å®šåˆ é™¤æ­¤ç½‘ç«™?')) return;
      data.sites[category].splice(index, 1);
      saveData();
      renderSites();
      renderManageLists();
    }

    function deleteEngine(index) {
      if (!confirm('ç¡®å®šåˆ é™¤æ­¤æœç´¢å¼•æ“?')) return;
      data.engines.splice(index, 1);
      saveData();
      renderEngines();
      renderManageLists();
    }

    // å›è½¦æœç´¢
    document.getElementById('searchInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') performSearch();
    });

    init();
  </script>
</body>
</html>