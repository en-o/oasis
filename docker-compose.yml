version: '3.8'

services:
  oasis-api:
    build:
      context: .
      dockerfile: api/Dockerfile
    container_name: oasis-api
    image: tannnn/oasis-api:latest
    ports:
      - "1249:1249"
    environment:
      # Oasis 配置环境变量
      OASIS_DEF_PWD: ${OASIS_DEF_PWD:-123}
      OASIS_DEF_UNAME: ${OASIS_DEF_UNAME:-tan}
      OASIS_DEF_SITE_TITLE: ${OASIS_DEF_SITE_TITLE:-Oasis}
      # 文件上传大小限制
      FILE_MAX_SIZE: ${FILE_MAX_SIZE:-500MB}
      FILE_MAX_REQUEST: ${FILE_MAX_REQUEST:-500MB}
    volumes:
      # 持久化数据库文件
      - ./api/db:/app/db
      # 可选：持久化日志
      - ./logs:/app/logs
    restart: unless-stopped
    networks:
      - oasis-network

networks:
  oasis-network:
    driver: bridge
